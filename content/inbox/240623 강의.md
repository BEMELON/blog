
# 빈 스코프

빈이 존재할 수 있는 범위 
 - 싱글톤 : 컨테이너의 시작고 ㅏ끝까지 살아남음
 - 프로토파입 : 빈의 생성과 의존관계 주입까지만 관여하고, 더는 관리하지 않음 
	 - ![[Pasted image 20240623131801.png]]
	- 요청할때마다 새로운 Bean을 만들어주고, 그 이후는 클라이언트에게 넘김

- WEB SCOPE : 웹 환경에서만 동작 
	- Request : 웹 요청이 들어오고 나갈때 까지 유지되는 스코프 
		- 처음 의존성 주입이 되지 않기 때문에 Provider를 사용해야 함 
			- Provider를 (@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)) 처럼 ProxyMode를 준다면 제거할 수 있음
				- 얘도 CGLIB, 가자 Proxy가 들어갔다가 실제 사용때 호출을 해버림
				- ![[Pasted image 20240623142451.png]]

	- Sesison : 웹 세션이 생성되고 종료될 떄 까지 유지되는 스코프 
	- Application : 웹의 서블릿 컨텍스와 같은 범위로 유지되는 스코프
	- websocket: 웹소켓과 동일한 생명 주기를 가지는 스코프

## 프로토타입과 싱글톤 타입으 빈을 함께 사용시 문제점 
- 싱글톤에 프로토타입 빈을 주입받아 사용하면, 사용자마다 새로운 프로토타입 빈을 사용하는게 아니라 같은 프로토타입 빈을 재사용함. 
	- 직접 필요한 의존관계를 찾느것을 DEpendency Lookup 이라고 한다. 
	- 이를 위해 Provider로 문제를 해결한다
		- ObjectFactory: 
		- ObjectProvider : Factory 상속, 편의 기능 많음 
		- 다른 컨테이너 지원이 필요하다면 JSR-330 Java 표준 사용, 별도의 Gradle 필요

- Request Sc